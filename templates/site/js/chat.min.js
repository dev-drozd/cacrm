var Timeout=void 0,Chat={init:function(){var t=$("#chat"),e=$(window);t.mousedown(function(a){if($(a.target).hasClass("chat-close"))$(".chat-dialog > .cd-block").length>2&&!localStorage.getItem("feedback")?Chat.feedback():(console.log("ok"),t.hide().css({bottom:"",left:"",top:"",transition:""}).find(".chat-title").css("cursor",""),e.unbind("mousemove"),$("#chat-btn").fadeIn());else if($(a.target).hasClass("chat-title")&&$(window).width()>650&&(t.removeClass("hide").find(".chat-title").css("cursor","move"),a.pageX&&a.pageY)){var s=t.position(),n=parseInt(s.left||0)-a.pageX,o=parseInt(s.top||0)-a.pageY;e.mousemove(function(e){t.css({bottom:"inherit",left:n+e.pageX,top:o+e.pageY,transition:"none"})}),$(".back-chat").show()}}),e.mouseup(function(){$(".back-chat").hide(),e.unbind("mousemove")}),$.get("/chat",function(e){if(t.find(".chat-name").text(e.name),t.find("#cnt").html(e.cnt),$(".chat-btn").click(),3!==e.step){var a=new Audio;a.src="/notify.mp3",a.volume=.3,a.play()}},"json")},mobScroll:function(){setTimeout(function(){$("#chat").scrollTop(999999)},300)},open:function(t){$(t).hide(),$("#chat").show(),$("#chat .chat-dialog").length&&$("#chat .chat-dialog").scrollTop(999999999)},feedback:function(){$(".chat-dialog .feedback-chat").length||$(".chat-dialog").append('<div class="feedback-chat">\t\t\t<p>Please rate our services.</p>\t\t\t<div class="rating" onmouseover="Chat.starFeedback(this, event);" onmouseout="Chat.starFeedback(this, event);" onclick="Chat.starFeedback(this, event);">\t\t\t\t<span class="fa fa-star rStart mini" ratting="1"></span>\t\t\t\t<span class="fa fa-star rStart mini" ratting="2"></span>\t\t\t\t<span class="fa fa-star rStart mini" ratting="3"></span>\t\t\t\t<span class="fa fa-star rStart mini" ratting="4"></span>\t\t\t\t<span class="fa fa-star rStart mini" ratting="5" onclick="window.open(\'https://search.google.com/local/writereview?placeid=\'+map_id)"></span>\t\t\t</div>\t\t</div>').scrollTop(999999999)},starFeedback:function(t,e,a,s){switch(e.preventDefault(),e.type){case"mouseover":for(var n=$(e.target).attr("ratting"),o=0;o<n;o++)$(t).find("span").eq(o).addClass("hover");break;case"mouseout":$(t).find("span").removeClass("hover");break;case"click":n=$(e.target).attr("ratting");var i=$(t).attr("data-rate");$(t).attr("data-rate",n),$(t).find("span").removeClass("active").removeClass("hover").removeClass("r_"+i);for(o=0;o<n;o++)$(t).find("span").eq(o).addClass("active").addClass("r_"+n);n>0&&$.post("/chat/feedback",{ratting:n},function(t){localStorage.setItem("feedback",1)})}},timeout:function(t){Timeout||(Timeout=setTimeout(function(){var t=new Audio;t.src="/notify.mp3",$("#chat .chat-dialog").append('<div class="cd-single">\t\t\t\t<label>Your Company:</label>\t\t\t\t<p>Thank you for your patience, a technician will respond in approximately 60 seconds.</p>\t\t\t</div>').scrollTop(999999999),t.play()},t||1e4))},auth:function(t){return t.preventDefault(),$.post("/chat/message",{name:t.target.name.value,email:t.target.email.value,phone:t.target.phone.value},function(t){Chat.timeout(300),$("#chat #cnt").html(t.msg)},"json"),!1},textarea:function(t){if(13!=t.keyCode&&10!=t.keyCode||0!=t.ctrlKey||(t.preventDefault(),$(t.target.form).submit()),(13==t.keyCode||10==t.keyCode)&&1==t.ctrlKey){t.preventDefault();if(t.target.focus(),document.selection)t.target.form.document.selection.createRange().text=t.target.form.document.selection.createRange().text+"\r\n";else if(null!=t.target.selectionStart){var e=t.target,a=e.value,s=e.selectionStart,n=e.selectionEnd-e.selectionStart;e.value=a.substr(0,s)+a.substr(s,n)+"\r\n"+a.substr(s+n)}else t.target.value+="\r\n"}return!1},msg:function(t){t.preventDefault();var e=t.target.message.value.trim(),a=$("#chat .chat-dialog .cd-single");t.target.message.value="",t.target.message.focus(),$("#chat").find(".chat-dialog").append('<div class="cd-block" data-id="">\t\t\t<div class="cd-image">\t\t\t\t<span class="fa fa-user-secret"></span>\t\t\t</div>\t\t\t<div class="cd-single">\t\t\t\t<label>Me:</label>\t\t\t\t<p>'+e+"</p>\t\t\t</div>\t\t</div>").scrollTop(999999999),$.post("/chat/message",{msg:e,im:a.length>0?1:0},function(t){Chat.timeout()},"json")}};