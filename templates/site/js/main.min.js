var page=0,query="",mob=0;$.getJSON("/language/"+lang_code+"/site/javascript.json",function(t){window.lang=t}),window.onload=function(){window.setTimeout(function(){window.addEventListener("popstate",function(t){t.preventDefault(),t.state?Page.get(t.state.link,!0):Page.get(window.location.pathname,!0)},!1)},1),menu(),Page.init(),Chat.init()};var is_valid={name:function(t){return new RegExp(/^[A-Za-za-яА-ЯїЇіІЄє']+$/).test(t)},email:function(t){return new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i).test(t)},phone:function(t){return new RegExp(/^[0-9-(-+]+$/i).test(t)},intval:function(t){return new RegExp(/^[0-9+]+$/i).test(t)}};function share(t){window.open(t,null,"width=600, height=400, top="+(screen.availHeight-500)/2+", left="+(screen.availWidth-600)/2)}var Search=function(t){query=t,$.post(location.pathname,{query:t},function(t){page=0,$("#res_count").text(t.res_count),$(".userList").html(t.content),t.left_count?$(".btnLoad").removeClass("hdn"):$(".btnLoad").addClass("hdn")},"json")},Doload=function(t){page+=1,$.post(location.pathname,{query:query,page:page},function(e){$("#cat").append(e.content),e.left_count||$(t).addClass("hdn")},"json")};function is_valid_email(t){return new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i).test(t)}function cart_login(t){t.preventDefault();let e=t.target,a=location.pathname;return $.post("/?login",{email:e.login_email.value,password:e.login_password.value},function(t){"OK"==t?"/cart/login"==a?cart.send(1):location.reload():"IP"==t?(alr.show({class:"alrDanger",content:"You can not login from this IP",delay:2}),$(".loginForm").show(0),$(".preloader").hide(0)):(alr.show({class:"alrDanger",content:"Wrong password. Please, try again.",delay:2}),$(".loginForm").show(0),$(".preloader").hide(0))}),!1}function login(t){var e=$("#email").val(),a=$("#password").val();is_valid_email(e)&&a.length>0&&e.length>0?($(".loginForm").hide(0),$(".preloader").show(0),$.post("/?login",{email:e,password:a},function(e){"OK"==e?"/cart/login"==t?location.href=location.origin+"/cart":location.reload():"IP"==e?(alr.show({class:"alrDanger",content:"You can not login from this IP",delay:2}),$(".loginForm").show(0),$(".preloader").hide(0)):(alr.show({class:"alrDanger",content:"Wrong password. Please, try again.",delay:2}),$(".loginForm").show(0),$(".preloader").hide(0))})):0==e.length?alr.show({class:"alrDanger",content:"Enter the email",delay:2}):is_valid_email(e)?alr.show({class:"alrDanger",content:"Enter the password.",delay:2}):alr.show({class:"alrDanger",content:"Email is not valid",delay:2})}function menu(){$(window).scroll(function(t){$(window).scrollTop()>140?$("body").addClass("fixed"):$("body").removeClass("fixed")})}function unsubscribe(){$(".page").html('<div class="err404 ctnr"><h1>Successfully unsubscribed</h1><p>You have successfully unsubscribed from our site.</p></div>')}var Page={init:function(t){page=0,query="",menu();for(var e="",a=0;a<locations.length;a++)e+='<option value="'+locations[a].id+'">'+locations[a].address+"</option>";$(".store-select").html(e),$("#page").select(),$("#page").tabs(),$("#page").inptel(),ga("send","pageview"),mob=0,$("#map").length&&initMap()},get:function(t,e){e||history.pushState({link:t},null,t),$(window).width()<=991?$(".hdr-nav > ul").hide():$(".hdr-nav > ul").show(),$.getJSON(t,function(e){"loggout"==e&&location.reload(),document.title=e.title,$("#page").html(e.content),mob||($(window).width()<=991?($(window).scrollTop($("#page").offset().top),$(".nvg ul").slideUp()):$(window).scrollTop(0)),Page.init(t)})}},account={sendApp:function(t){loadBtn.start($(t));var e={},a=null;$('input[name="sdate"]').val()?$('input[name="time"]').val()?Object.keys($('input[name="object"]').data())[0]?new Date($('input[name="sdate"]').val())<new Date?a="Date can not be less from today's date":(e.date=$('input[name="sdate"]').val(),e.time=$('input[name="time"]').val(),e.object=Object.keys($('input[name="object"]').data())[0]):a="Select store":a="Enter time":a="Enter date",a?(alr.show({class:"alrDanger",content:a,delay:2}),loadBtn.stop($(t).find("button"))):$.post("/account/send_app",e,function(e){loadBtn.stop($(t).find("button")),"OK"==e?(alr.show({class:"alrSuccess",content:"Appointment was successfully added",delay:2}),Page.get(location.href),mdl.close()):alr.show({class:"alrDanger",content:lang[13],delay:2})})},addApp:function(t){$.post("/account/allObjects",{},function(t){var e="",a=0;t.list&&$.each(t.list,function(t,n){e+='<li data-value="'+n.id+'">'+n.name+"</li>",a=n.id}),mdl.open({id:"addAppointment",title:"On appointment",content:$("<div/>",{class:"uForm",html:'<div class="iGroup fw dGroup act">\t\t\t\t\t\t\t\t<label>Date</label>\t\t\t\t\t\t\t\t<input type="text" name="sdate" class="cl" onclick="$(this).next().show();">\t\t\t\t\t\t\t\t<div id="calendar" class="hdn cl"></div>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="iGroup fw">\t\t\t\t\t\t\t\t<label>Time</label>\t\t\t\t\t\t\t\t<input type="time" name="time">\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="iGroup fw sfGroup" id="object">\t\t\t\t\t\t\t\t<label>Store</label>\t\t\t\t\t\t\t\t<input type="hidden" name="object" />\t\t\t\t\t\t\t\t<ul class="hdn"></ul>\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t<div class="sGroup">\t\t\t\t\t\t\t\t<button class="btn btnSubmit" type="button" onclick="account.sendApp(this);"><span class="fa fa-save"></span> Send</button>\t\t\t\t\t\t\t</div>'}),cb:function(){$("#calendar").calendar(function(){$('#calendar > input[name="date"]').val().split("-");$('input[name="sdate"]').val($('#calendar > input[name="date"]').val()),$(".dGroup > input + div").hide().parent().removeClass("act")}),$(".uForm").on("click",function(t){$(t.target).hasClass("cl")||(console.log($(t.target).hasClass("cl")),$(".calendar").hide().parents(".iGroup").removeClass("act"))}),$("#object > ul").html(e).sForm({action:"/account/allObjects",data:{lId:a,query:$("#object > .sfWrap input").val()||""},all:!1,select:$('input[name="object"]').data(),s:!0},$('input[name="object"]'))}})},"json")},addOnsite:function(t){$.post("/account/allObjects",{},function(e){var a="",n=0;e.list&&$.each(e.list,function(t,e){a+='<li data-value="'+e.id+'">'+e.name+"</li>",n=e.id}),mdl.open({id:"addOnsite",title:"On site service",content:$("<div/>",{class:"uForm",html:$("<div/>",{class:"iGroup fw price",id:"object",html:$("<label/>",{html:"Store"})}).append($("<input/>",{type:"hidden",name:"object"})).append($("<ul/>",{class:"hdn",html:a}))}).append($("<div/>",{class:"iGroup fw",id:"service",html:$("<label/>",{html:"Service"})}).append($("<input/>",{type:"hidden",name:"service"})).append($("<ul/>",{class:"hdn"}))).append($("<div/>",{class:"iGroup fw dGroup ",html:$("<label/>",{html:"Start date"})}).append($("<input/>",{type:"text",class:"cl",name:"date_start",onclick:"closeCalendar(); $(this).next().show().parent().addClass('act');"})).append($("<div/>",{id:"sCalendar"}))).append($("<div/>",{class:"iGroup fw dGroup ",html:$("<label/>",{html:"End date"})}).append($("<input/>",{type:"text",class:"cl",name:"date_end",onclick:"closeCalendar(); $(this).next().show().parent().addClass('act');"})).append($("<div/>",{id:"eCalendar"}))).append($("<div/>",{class:"iGroup fw",html:$("<label/>",{html:"Time"})}).append($("<input/>",{type:"time",name:"time"}))).append($("<div/>",{class:"sGroup",html:$("<button/>",{type:"button",class:"btn btnSubmit",onclick:"account.sendService(this, "+t+");",html:"Done"})})),cb:function(){$("#sCalendar").calendar(function(){$('input[name="date_start"]').val($('#sCalendar > input[name="date"]').val()),$(".dGroup > input + div").hide().parent().removeClass("act")}),$("#eCalendar").calendar(function(){$('input[name="date_end"]').val($('#eCalendar > input[name="date"]').val()),$(".dGroup > input + div").hide().parent().removeClass("act")}),$(".uForm").on("click",function(t){$(t.target).hasClass("cl")||(console.log($(t.target).hasClass("cl")),$(".calendar").hide().parents(".iGroup").removeClass("act"))}),$("#object > ul").html(a).sForm({action:"/account/allObjects",data:{lId:n,query:$("#object > .sfWrap input").val()||""},all:!1,select:$('input[name="object"]').data(),s:!0},$('input[name="object"]'),account.getOnsite),account.getOnsite()}})},"json")},getOnsite:function(){$.post("/account/AllOnsite",{oId:Object.keys($('input[name="object"]').data()||{}).join(",")},function(t){var e="",a=0;t.list&&($.each(t.list,function(t,n){e+='<li data-value="'+n.id+'" data-price="'+n.currency+parseFloat(n.price).toFixed(2)+'">'+n.name+"</li>",a=n.id}),$("#service > .sfWrap").length&&($('input[name="service"]').removeData(),$("#service > .sfWrap").remove(),$("#service").append($("<ul/>",{class:"hdn"}))),$("#service > ul").html(e).sForm({action:"/inventory/AllOnsite",data:{lId:a,oId:Object.keys($('input[name="object"]').data()||{}).join(","),query:$("#service > .sfWrap input").val()||""},all:!1,select:$('input[name="service"]').data(),s:!0},$('input[name="service"]')))},"json")},sendService:function(t,e){loadBtn.start($(t));var a={id:e,date_start:$('input[name="date_start"]').val(),date_end:$('input[name="date_end"]').val(),time:$('input[name="time"]').val()},n=null;Object.keys($('input[name="service"]').data()).join(",")?a.service=Object.keys($('input[name="service"]').data()).join(","):n="Please, choose service",Object.keys($('input[name="object"]').data()).join(",")?a.object=Object.keys($('input[name="object"]').data()).join(","):n="Please, choose object",n?(alr.show({class:"alrDanger",content:n,delay:2}),loadBtn.stop($(t))):$.post("/account/send_service",a,function(e){loadBtn.stop($(t)),"OK"==e?(alr.show({class:"alrSuccess",content:"The service was successfully added",delay:2}),Page.get(location.href),mdl.close()):alr.show({class:"alrDanger",content:lang[13],delay:2})})},toggleList:function(t,e){$(e.target).parents(".td").hasClass("w100")||$(e.target).parents(".td").hasClass("w5")||$(t).toggleClass("open").next().slideToggle()},login:function(){mdl.open({id:"login",class:"login",title:"Login form",content:$("<div/>",{html:$("<div/>",{class:"loginForm",html:$("<div/>",{class:"lGroup",html:$("<span/>",{class:"fa fa-user"})}).append($("<input/>",{type:"text",placeholder:"Login",name:"login",id:"email"}))}).append($("<div/>",{class:"lGroup",html:$("<span/>",{class:"fa fa-lock"})}).append($("<input/>",{type:"password",id:"password",placeholder:"Password",name:"password"}))).append($("<div/>",{class:"lGroup",html:$("<button/>",{html:"Login",class:"btn btnLogin",type:"button",onclick:"login();"})})).append($("<div/>",{class:"orReg",html:$("<span/>",{html:"or"})}).append($("<button/>",{class:"btn btnReg",html:"Registration",onclick:"account.registration();"})))}).append($("<div/>",{class:"preloader",html:$("<span/>",{class:"fa fa-cog fa-spin"})}))})},registration:function(){$("#login").remove(),mdl.open({id:"reg",class:"reg",title:"Registration",content:$("<div/>",{class:"regForm",html:$("<div/>",{class:"regSteps",html:$("<span/>",{class:"fStep",html:"1",onclick:"$('#reg .regForm').removeClass('next');"})}).append($("<span/>",{class:"sStep",html:"2",onclick:"account.authNext(this);"}))}).append($("<div/>",{class:"step fStep",html:$("<div/>",{class:"input-group fw w50",html:$("<label/>",{html:"Name"})}).append($("<input/>",{type:"text",placeholder:"Name",name:"name"}))}).append($("<div/>",{class:"input-group fw w50",html:$("<label/>",{html:"Lastname"})}).append($("<input/>",{type:"text",placeholder:"Lastname",name:"lastname"}))).append($("<div/>",{class:"input-group fw",html:$("<label/>",{html:"Phone"})}).append($("<input/>",{type:"text",placeholder:"Phone",name:"phone"}))).append($("<div/>",{class:"input-group fw",html:$("<label/>",{html:"Address"})}).append($("<textarea/>",{cols:"3",placeholder:"Address",name:"address"}))).append($("<div/>",{class:"input-group",html:$("<button/>",{html:"Next",class:"btn btnLogin",type:"button",onclick:"account.authNext(this);"})}))).append($("<div/>",{class:"step sStep",html:$("<div/>",{class:"input-group fw",html:$("<label/>",{html:"Email"})}).append($("<input/>",{type:"email",placeholder:"Email",name:"email"}))}).append($("<div/>",{class:"input-group fw",html:$("<label/>",{html:"Password"})}).append($("<input/>",{type:"password",placeholder:"Password",name:"password"}))).append($("<div/>",{class:"input-group fw",html:$("<label/>",{html:"Repeat rassword"})}).append($("<input/>",{type:"password",placeholder:"Password",name:"password2"}))).append($("<div/>",{class:"a-right",html:$("<button/>",{html:"Registration",class:"btn btnLogin",type:"button",onclick:"account.auth(this);"})})))})},editUser:function(t,e,a){e.preventDefault(),loadBtn.start($(e.target).find('button[type="submit"]'));var n=new FormData,l=$(t).serializeArray(),s=null;n.append("id",a);for(var o=0;o<l.length;o++){if("email"==l[o].name){if(!l[o].value.length||!is_valid.email(l[o].value)){s=l[o].value.length?lang[2]:lang[3];break}}else if("phone"==l[o].name){if(!l[o].value.length||!is_valid.phone(l[o].value)){s=l[o].value.length?lang[4]:lang[5];break}}else if("name"==l[o].name||"lastname"==l[o].name){if(!is_valid.name(l[o].value)||!is_valid.name(l[o].value)){s=lang[6];break}}else if("password"==l[o].name&&l[o].value.length>0&&l[o].value!=$('input[name="password2"]').val()){s=lang[7];break}n.append(l[o].name,l[o].value)}var i="",r=0;if($(".sPhone").each(function(t,e){if($(e).find("input").css("border","1px solid #ddd"),$(e).find("select").val()||$(e).find("input").val()){if(!($(e).find('[name="phoneCode"]').val()&&$(e).find('[name="code"]').val()&&$(e).find('[name="part1"]').val()))return $(e).find("input").css("border","1px solid #f00"),s="Please, check phone number",!1;i.length>0&&(i+=","),i+=$(e).find('[name="phoneCode"]').val()+" "+$(e).find('[name="code"]').val()+" "+$(e).find('[name="part1"]').val()+" "+$(e).find('[name="part2"]').val(),1==$(e).find('[name="sms"]').val()&&(n.append("sms",$(e).find('[name="phoneCode"]').val()+" "+$(e).find('[name="code"]').val()+" "+$(e).find('[name="part1"]').val()),r=1)}}),i.length?(n.append("phone",i),console.log(i)):s||(s="Phone can not be empty"),r||n.append("sms",""),s)return alr.show({class:"alrDanger",content:s,delay:2}),void loadBtn.stop($(e.target).find('button[type="submit"]'));$.ajax({type:"POST",processData:!1,contentType:!1,url:"/account/editUser",data:n}).done(function(t){loadBtn.stop($(e.target).find('button[type="submit"]')),t>0?(alr.show({class:"alrSuccess",content:lang[8],delay:2}),Page.get("/account/")):alr.show({class:"alrDanger",content:lang[10],delay:2})})},auth:function(t){loadBtn.start($(t));var e={},a="";$(t).parents(".regForm").find(".input-group").find("label").next().css("border","1px solid #b8b8b8"),$(t).parents(".regForm").find(".input-group").each(function(t,n){if(!$(n).find("label").next().val())return a=$(n).text()+" can not be empty",$(n).find("label").next().css("border","1px solid #f00"),!1;e[$(n).find("label").next().attr("name")]=$(n).find("label").next().val()}),a?(loadBtn.stop($(t)),alr.show({class:"alrDanger",content:a,delay:2})):$('input[name="password"]').val()==$('input[name="password2"]').val()?$.post("/reg/",e,function(e){loadBtn.stop($(t)),"OK"==e?(alr.show({class:"alrSuccess",content:"You successfully registered on Your Company! Please, check Your email to confirm Your account.",delay:2}),$(".mdl").length?mdl.close():Page.get("/")):alr.show({class:"alrDanger",content:"It seems something wrong, Please, try again.",delay:2})}):(alr.show({class:"alrDanger",content:"Passwords are not matched",delay:2}),$('input[name="password"]').css("border","1px solid #f00"),$('input[name="password2"]').css("border","1px solid #f00"))},authNext:function(t){var e="";$(t).parents(".regForm").find(".fStep .input-group").find("label").next().css("border","1px solid #ddd"),$(t).parents(".regForm").find(".fStep .input-group").each(function(t,a){if(!$(a).find("label").next().val())return e=$(a).text()+" can not be empty",$(a).find("label").next().css("border","1px solid #f00"),!1}),e?alr.show({class:"alrDanger",content:e,delay:2}):$(t).parents(".regForm").addClass("next")},addDevice:function(t){$.post("/account/allOS",{},function(t){if(t){var e="";$.each(t.list,function(t,a){e+='<option value="'+a.id+'">'+a.name+"</option>"}),$.post("/account/allCategories",{},function(t){var a="",n=0;$.each(t.list,function(t,e){a+='<li data-value="'+e.id+'">'+e.name+"</li>",n=e.id}),$.post("/account/allTypes",{},function(t){var l="",s=0;$.each(t.list,function(t,e){l+='<li data-value="'+e.id+'">'+e.name+"</li>",s=e.id}),mdl.open({id:"createDevice",title:"Add device",content:$("<div/>",{class:"form",html:$("<div/>",{class:"iGroup fw",id:"type",html:$("<label/>",{html:"Type"})}).append($("<input/>",{type:"hidden",name:"type"})).append($("<ul/>",{html:l,class:"hdn"}))}).append($("<div/>",{class:"iGroup fw",id:"brand",html:$("<label/>",{html:"Brand"})}).append($("<input/>",{type:"hidden",name:"brand"})).append($("<ul/>",{class:"hdn",html:a}))).append($("<div/>",{class:"iGroup fw",id:"model",html:$("<label/>",{html:"Model"})}).append($("<input/>",{type:"hidden",name:"model"})).append($("<ul/>",{class:"hdn"}))).append($("<div/>",{class:"iGroup fw",html:$("<label/>",{html:"Model Specification"})}).append($("<input/>",{type:"text",name:"smodel"}))).append($("<div/>",{class:"iGroup  fw",id:"os",html:$("<label/>",{html:"OS"})}).append($("<select/>",{name:"os",html:e}))).append($("<div/>",{class:"iGroup fw",html:$("<label/>",{html:"OS version"})}).append($("<input/>",{type:"text",name:"os_ver"}))).append($("<div/>",{class:"iGroup fw",html:$("<label/>",{html:"Serial Number"})}).append($("<input/>",{type:"text",name:"sn"}))).append($("<div/>",{class:"sGroup",html:$("<button/>",{type:"button",class:"btn btnSubmit",onclick:"account.sendDev(this);",html:"Send"})})),cb:function(){$("#page").select(),$("#brand > ul").sForm({action:"/account/allCategories",data:{lId:n,nIds:Object.keys($('input[name="brand"]').data()).join(","),query:$("#brand > .sfWrap input").val()},all:!1,select:$('input[name="brand"]').data(),s:!0},$('input[name="brand"]'),account.getGroup),$("#type > ul").sForm({action:"/account/allTypes",data:{lId:s,nIds:Object.keys($('input[name="type"]').data()).join(","),query:$("#type > .sfWrap input").val()},all:!1,select:$('input[name="type"]').data(),s:!0},$('input[name="type"]')),account.getGroup()}})},"json")},"json")}},"json")},sendDev:function(t,e){loadBtn.start($(t));var a=new FormData,n=$(t).parents(".form"),l=null;e&&a.append("id",e),n.find(".iGroup > input").css("border","1px solid #ddd"),n.find(".sWrap").css("border","1px solid #ddd"),n.find('input[name="brand"]').data()?0==n.find('select[name="type"]').val()?l=lang[123]:(a.append("type",Object.keys(n.find('input[name="type"]').data()).join(",")),a.append("smodel",n.find('input[name="smodel"]').val()||""),a.append("os",n.find('select[name="os"]').val()||""),a.append("os_version",n.find('input[name="os_ver"]').val()||""),a.append("serial",n.find('input[name="sn"]').val()||""),a.append("category",Object.keys(n.find('input[name="brand"]').data()||{}).join(",")),a.append("model",Object.keys(n.find('input[name="model"]').data()||{}).join(",")),a.append("intype","stock")):l=lang[124],l?(alr.show({class:"alrDanger",content:l,delay:2}),loadBtn.stop($(t))):$.ajax({type:"POST",processData:!1,contentType:!1,url:"/account/send_inventory",data:a}).done(function(e){loadBtn.stop($(t)),e?(alr.show({class:"alrSuccess",content:lang[122],delay:2}),e>0&&(Page.get(location.pathname),mdl.close())):alr.show({class:"alrDanger",content:lang[13],delay:2})})},delDevice:function(t){$.post("/account/del_inventory",{id:t},function(e){"OK"==e?($("#dev_"+t).next().remove(),$("#dev_"+t).remove()):alr.show({class:"alrDanger",content:lang[9],delay:2})})},addIssue:function(t){var e="";$.post("/account/allObjects",{},function(a){a&&($.each(a.list,function(t,a){e+='<option value="'+a.id+'"'+(0==t?" selected":"")+">"+a.name+"</option>",lId=a.id}),mdl.open({id:"newIssue",title:"Add issue",content:$("<div/>",{class:"form",html:$("<div/>",{class:"iGroup fw",html:$("<label/>",{html:"Store"})}).append($("<select/>",{name:"store",html:e}))}).append($("<div/>",{class:"iGroup fw",html:$("<label/>",{html:"Description"})}).append($("<textarea/>",{name:"descr"}))).append($("<div/>",{class:"sGroup",html:$("<button/>",{type:"button",class:"btn btnSubmit",onclick:"account.sendIssue(this, "+t+")",html:"Send"})})),cb:function(){$("select").select()}}))},"json")},sendIssue:function(t,e){(t=$(t).parents(".form")).find('textarea[name="descr"]').val()?$.post("/account/add_issue",{id:e,descr:t.find('textarea[name="descr"]').val(),store:t.find('select[name="store"]').val()},function(t){t?(alr.show({class:"alrSuccess",content:"Issue was successfully added",delay:2}),mdl.close(),Page.get(location.href)):alr.show({class:"alrDanger",content:lang[9],delay:2})},"json"):alr.show({class:"alrDanger",content:"Description can not be empty",delay:2})},getGroup:function(t,e,a){var n="";$.post("/account/allModels",{brand:Object.keys($('input[name="brand"]').data()).join(",")},function(t){t&&($.each(t.list,function(t,e){n+='<li data-value="'+e.id+'">'+e.name+"</li>",e.id}),a||($("#model > input").removeData(),$("#model > input").next().remove(),$("#model").append($("<ul/>",{html:n}))),!brand_id&&model_id&&($("#model > input").data(model_id),model_id=""),$("#model > ul").sForm({action:"/account/allModels",data:{nIds:Object.keys($('input[name="model"]').data()).join(","),query:$("#model > .sfWrap input").val()},all:!0,select:$('input[name="model"]').data(),s:!0},$('input[name="model"]')))},"json")}},cart={saveDelivery:function(t){$.post("/cart/save_delivery",{v:t},function(t){})},pay:function(t,e,a){e.preventDefault(),loadBtn.start($(e.target).find('button[type="submit"]'));var n=new FormData,l=$(t).serializeArray(),s=null;n.append("id",a);for(var o=0;o<l.length;o++){if("card-number"==l[o].name){if(!l[o].value.length||16!=l[o].value.length){s=l[o].value.length?"Card number is incorrect":"Card nu,ber can not be empty";break}}else if("code"==l[o].name&&!l[o].value.length){s="CVV code can not be empty";break}n.append(l[o].name,l[o].value)}if(s)return alr.show({class:"alrDanger",content:s,delay:2}),void loadBtn.stop($(e.target).find('button[type="submit"]'));$.ajax({type:"POST",processData:!1,contentType:!1,url:"/cart/send_pay",data:n}).done(function(t){loadBtn.stop($(e.target).find('button[type="submit"]')),"OK"==t?(alr.show({class:"alrSuccess",content:"Your invoice was successfully paid",delay:2}),Page.get("/account/")):"trans_failed"==t?alr.show({class:"alrDanger",content:"Transaction failed. Please try again later",delay:2}):"card_failed"==t?alr.show({class:"alrDanger",content:"Transaction failed. Please, check you credit card info",delay:2}):alr.show({class:"alrDanger",content:"It seems something wrong. Please try again later",delay:2})})},add:function(t,e,a){$.post("/cart/add",{id:t},function(n){"in_cart"==n?alr.show({class:"alrDanger",content:"Item are alredy in cart",delay:2}):(alr.show({class:"alrSuccess",content:"Item was successfully added to cart",delay:2}),$(".mini-cart > ul").prepend($("<li/>",{id:"miniCart_"+t,html:$("<a/>",{href:"/item/"+t,html:e,onclick:"Page.get(this.href); return false;"})}).append($("<span/>",{class:"cartPrice",html:"$"+a}))),$(".cartSubtotal > span:last-child").html("$"+(parseFloat($(".cartSubtotal > span:last-child").text().replace("$",""))+parseFloat(a))))})},del:function(t,e){$.post("/cart/del",{id:t},function(a){if(a){$("#cart_"+t).remove(),alr.show({class:"alrSuccess",content:"Item was successfully deleted from cart",delay:2}),1==parseInt($(".hCart > div > i").text())?$(".hCart > div > i").remove():$(".hCart > div > i").html(parseInt($(".hCart > div > i").text())-1),$("#miniCart_"+t).remove(),$(".cartSubtotal > span").html($(".cartSubtotal > span").text().replace(/[0-9.\s]/g,"")+(parseFloat($(".cartSubtotal > span").text().replace(/[^0-9.]/g,""))-parseFloat(e))),$("#subtotal").html((parseFloat($("#subtotal").text())-parseFloat(e)).toFixed(2));var n=(parseFloat($("#tax").text())-a*parseFloat(e)/100).toFixed(2);$("#tax").html(n<0?0:n),$("#total").html((parseFloat($("#subtotal").text())+parseFloat($("#tax").text())).toFixed(2)),$(".hCart > div > i").length||$(".miniCart").addClass("nCart")}else alr.show({class:"alrDanger",content:"It's something wrong. Please, try again",delay:2})})},clear:function(){$.post("/cart/clear",{},function(t){"OK"==t?($("#subtotal").html(0),$("#tax").html(0),$("#total").html(0),$('[id*="cart"]').remove(),$('[id*="miniCart"]').remove(),$(".cartSubtotal > span").html("$0"),$(".hCart > div > i").remove(),$(".miniCart").addClass("nCart")):alr.show({class:"alrDanger",content:"It's something wrong. Please, try again",delay:2})})},changeDelivery:function(){var t=$('select[name="delivery"] option[value="'+$('select[name="delivery"]').val()+'"]');$("#total").html(parseFloat(parseFloat($("#total").attr("data-total"))+parseFloat(t.attr("data-price"))).toFixed(2)),$.post("/cart/change_delivery",{id:$('select[name="delivery"]').val(),price:t.attr("data-price"),currency:t.attr("data-currency")})},changePayment:function(){$.post("/cart/payment",{id:$('select[name="payment"]').val()})},send:function(t){var e=new FormData;e.append("delivery",$('select[name="delivery"]').val()),e.append("total",parseFloat($("#total").text())),e.append("tax",parseFloat($("#total").attr("data-tax"))),e.append("currency",$("#total").attr("data-currency")),$.ajax({type:"POST",processData:!1,contentType:!1,url:"/cart/send",data:e}).done(function(e){parseInt(e)>0?t?location.href="/cart/delivery/"+parseInt(e):Page.get("/cart/delivery/"+parseInt(e)):(alr.show({class:"alrDanger",content:"It's something wrong. Please, try again later.",delay:2}),t?location.reload():Page.get(location.href))})},sendDelivery:function(t,e,a){e.preventDefault();var n=new FormData;n.append("id",a),n.append("country",Object.keys($('input[name="country"]').data())[0]),n.append("state",Object.keys($('input[name="state"]').data())[0]),n.append("city",Object.keys($('input[name="city"]').data())[0]),n.append("zipcode",$('input[name="zipcode"]').val()),n.append("address",$('textarea[name="address"]').val()),$.ajax({type:"POST",processData:!1,contentType:!1,url:"/cart/send_delivery",data:n}).done(function(t){parseInt(t)>0?Page.get("/cart/pay/"+parseInt(t)):(alr.show({class:"alrDanger",content:"It's something wrong. Please, try again later.",delay:2}),Page.get(location.href))})}};function showText(t){$(t).hasClass("show")?$(t).removeClass("show").text("More text").prev().animate({height:152},1e3,function(){$(this).height("152px")}):$(t).addClass("show").text("Less text").prev().animate({height:$(t).prev().get(0).scrollHeight},1e3,function(){$(this).height("auto")})}var phones={newPhone:function(){$(".nPhone").before($("<div/>",{class:"sPhone",html:$("<span/>",{class:"fa fa-times rd",onclick:"$(this).parent().remove();"})}).append($("<select/>",{name:"phoneCode",html:$("<option/>",{value:"0",html:"None"})}).append($("<option/>",{value:"+1",html:"+1"})).append($("<option/>",{value:"+3",html:"+3"}))).append($("<span/>",{class:"wr",html:"("})).append($("<input/>",{type:"number",name:"code",max:"999",onkeyup:"phones.next(this, 3);"})).append($("<span/>",{class:"wr",html:")"})).append($("<input/>",{type:"number",name:"part1",onkeyup:"phones.next(this, 7);"})).append($("<input/>",{type:"number",name:"part2"})).append($("<input/>",{type:"checkbox",name:"sms",onchange:"phones.onePhone(this);"}))),$("#page").select(),$("#page").checkbox()},onePhone:function(t){var e=$(t).val();$('input[name="sms"]').attr("onchange","").val(0).prop("checked",0),1==e&&$(t).val(1).prop("checked",1),$('input[name="sms"]').attr("onchange","phones.onePhone(this);")},next:function(t,e){$(t).val().length==e&&($(t).next().hasClass("wr")?$(t).next().next().focus():$(t).next().focus())}};function sendFeedback(t,e){e.preventDefault();var a={},n=null;$(t).find('input[name="full_name"]').val()?$(t).find('input[name="email"]').val()?$(t).find('textarea[name="message"]').val()?a={name:$(t).find('input[name="full_name"]').val(),email:$(t).find('input[name="email"]').val(),mes:$(t).find('textarea[name="message"]').val(),to:$(".map-list .active").attr("data-email")||""}:n="Message can not be empty":n="Email can not be empty":n="Name can not be empty",n?alr.show({class:"alrDanger",content:n,delay:2}):$.post("/contact-us/send_feedback",a,function(e){"OK"==e?(alr.show({class:"alrSuccess",content:"Feedback was successfully sent",delay:2}),$(t).find('input[name="full_name"]').val(""),$(t).find('input[name="email"]').val(""),$(t).find('textarea[name="message"]').val("")):"err_email"==e?alr.show({class:"alrDanger",content:"Email is incorrect. Please, check it",delay:2}):alr.show({class:"alrDanger",content:"It's something wrong. Please, try again",delay:2})})}function closeCalendar(){$(".calendar").hide().parent().removeClass("act")}function closeWindow(){mdl.open({id:"closeWindow",title:"Share us",class:"share-social",content:"<p>"+lang[175]+'</p>\t\t\t<ul class="share-discount">\t\t\t\t<li onclick="share(\'https://www.facebook.com/sharer/sharer.php?u='+location.origin+"/?ref="+user.id+'\');"><span class="fa fa-facebook"></span> Facebook</li>\t\t\t\t<li onclick="share(\'https://twitter.com/home?status='+location.origin+"/?ref="+user.id+'\');"><span class="fa fa-twitter"></span> Twitter</li>\t\t\t\t<li onclick="share(\'https://plus.google.com/share?url='+location.origin+"/?ref="+user.id+'\');"><span class="fa fa-google-plus"></span> Google+</li>\t\t\t</ul>'});var t=new Date;t.setTime(t.getTime()+36e5),document.cookie="showWindow=1;expires="+t.toUTCString()+";path=/"}function getCookie(t){for(var e=t+"=",a=decodeURIComponent(document.cookie).split(";"),n=0;n<a.length;n++){for(var l=a[n];" "==l.charAt(0);)l=l.substring(1);if(0==l.indexOf(e))return l.substring(e.length,l.length)}return""}function scrollID(t,e){e.preventDefault();var a=$(t).attr("href").replace("#","");$("body").scrollTop($('a[name="'+a+'"]').offset().top)}var quote={mdl:function(t){mdl.open({id:"quote-mdl",title:t?"Call request":"Get quote",content:'<div class="quote-steps">\t\t\t\t<div class="qs-step active">\t\t\t\t'+(null==user?'<div class="input-group fw">\t\t\t\t\t\t<label>Company </label>\t\t\t\t\t\t<input type="text" placeholder="Company name" name="company">\t\t\t\t\t</div>\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t<label>Name <span class="red">*</span></label>\t\t\t\t\t\t<input type="text" placeholder="Name" name="name">\t\t\t\t\t</div>\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t<label>Lastname <span class="red">*</span></label>\t\t\t\t\t\t<input type="text" placeholder="Lastname" name="lastname">\t\t\t\t\t</div>\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t<label>Phone <span class="red">*</span></label>\t\t\t\t\t\t<input type="tel" name="phone" placeholder="+X (XXX) XXX-XXXX" value="+1">\t\t\t\t\t</div>\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t<label>Email <span class="red">*</span></label>\t\t\t\t\t\t<input type="email" placeholder="Email" name="email">\t\t\t\t\t</div>':"")+'\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t<label>Store <span class="red">*</span></label>\t\t\t\t\t\t<select name="store"></select>\t\t\t\t\t</div>\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t<label>Your issue <span class="red">*</span></label>\t\t\t\t\t\t<textarea cols="3" placeholder="Issues" name="issue"></textarea>\t\t\t\t\t</div>\t\t\t\t\t<div class="submit-group">\t\t\t\t\t\t<button class="btn btnLogin" type="button" onclick="quote.send(this);">Send</button>\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div>',cb:function(){for(var t="",e=0;e<locations.length;e++)t+='<option value="'+locations[e].id+'">'+locations[e].address+"</option>";$("select[name=store]").html(t),$("#page").select(),$("#quote-mdl").inptel()}})},mdl2:function(){$.post("/account/allOS",{},function(t){if(t){var e="";$.each(t.list,function(t,a){e+='<option value="'+a.id+'">'+a.name+"</option>"}),$.post("/account/allCategories",{},function(t){var a="",n=0;$.each(t.list,function(t,e){a+='<li data-value="'+e.id+'">'+e.name+"</li>",n=e.id}),$.post("/account/allTypes",{},function(t){var l="",s=0;$.each(t.list,function(t,e){l+='<li data-value="'+e.id+'">'+e.name+"</li>",s=e.id}),$.post("/account/allObjects",{},function(t){var o="";$.each(t.list,function(t,e){o+='<option value="'+e.id+'">'+e.name+"</option>",e.id}),mdl.open({id:"quote-mdl",title:"Get quote",content:'<div class="quote-steps">\t\t\t\t\t\t\t\t\t'+(null==user?'<div class="qs-step active">\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Name <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" placeholder="Name" name="name">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Lastname <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" placeholder="Lastname" name="lastname">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Phone <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" placeholder="Phone" name="phone">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Email <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="email" placeholder="Email" name="email">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Address <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<textarea cols="3" placeholder="Address" name="address"></textarea>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="submit-group">\t\t\t\t\t\t\t\t\t\t\t<button class="btn btnLogin" type="button" onclick="quote.next(this);">Next</button>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>':"")+'\t\t\t\t\t\t\t\t\t<div class="qs-step'+(null==user?"":" active")+'">\t\t\t\t\t\t\t\t\t\t<div class="input-group fw" id="type">\t\t\t\t\t\t\t\t\t\t\t<label>Type <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="type">\t\t\t\t\t\t\t\t\t\t\t<ul class="hdn"></ul>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw" id="brand">\t\t\t\t\t\t\t\t\t\t\t<label>Brand <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="brand">\t\t\t\t\t\t\t\t\t\t\t<ul class="hdn"></ul>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw" id="model">\t\t\t\t\t\t\t\t\t\t\t<label>Model <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="hidden" name="model">\t\t\t\t\t\t\t\t\t\t\t<ul class="hdn"></ul>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Model Specification <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" name="smodel">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>OS <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<select name="os">'+e+'</select>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>OS version</label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" name="os_ver">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Serial number</label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" name="sn">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="submit-group">\t\t\t\t\t\t\t\t\t\t\t'+(null==user?'<button class="btn btnLogin" style="float: left;" type="button" onclick="quote.prev(this);">Previous</button>':"")+'\t\t\t\t\t\t\t\t\t\t\t<button class="btn btnLogin" type="button" onclick="quote.next(this);">Next</button>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t<div class="qs-step">\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Your issue <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<textarea cols="3" placeholder="Issues" name="issue"></textarea>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw dGroup act">\t\t\t\t\t\t\t\t\t\t\t<label>Date <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="text" name="sdate" class="cl" onclick="$(this).next().show();">\t\t\t\t\t\t\t\t\t\t\t<div id="calendar" class="hdn cl calendar"></div>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group fw">\t\t\t\t\t\t\t\t\t\t\t<label>Time <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<input type="time" name="time">\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="input-group  fw">\t\t\t\t\t\t\t\t\t\t\t<label>Store <span class="red">*</span></label>\t\t\t\t\t\t\t\t\t\t\t<select name="store">'+o+'</select>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\t<div class="submit-group">\t\t\t\t\t\t\t\t\t\t\t<button class="btn btnLogin" style="float: left;" type="button" onclick="quote.prev(this);">Previous</button>\t\t\t\t\t\t\t\t\t\t\t<button class="btn btnLogin" type="button" onclick="quote.send(this);">Send</button>\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t</div>',cb:function(){$("#page").select(),$("#calendar").calendar(function(){$('input[name="sdate"]').val($('#calendar > input[name="date"]').val()),$(".dGroup > input + div").hide().parent().removeClass("act")}),brand_id=0,model_id=0,$("#brand > ul").html(a).sForm({action:"/account/allCategories",data:{lId:n,nIds:Object.keys($('input[name="brand"]').data()).join(","),query:$("#brand > .sfWrap input").val()},all:!1,select:$('input[name="brand"]').data(),s:!0},$('input[name="brand"]'),account.getGroup),$("#type > ul").html(l).sForm({action:"/account/allTypes",data:{lId:s,nIds:Object.keys($('input[name="type"]').data()).join(","),query:$("#type > .sfWrap input").val()},all:!1,select:$('input[name="type"]').data(),s:!0},$('input[name="type"]'))}})},"json")},"json")},"json")}},"json")},next:function(t){$(t).parent().parent().removeClass("active").next().addClass("active")},prev:function(t){$(t).parent().parent().removeClass("active").prev().addClass("active")},send:function(t,e){var a={},n=null;$(t).parents(".quote-steps").find(".req").removeClass("req"),$(t).parents(".quote-steps").find("[name]").each(function(t,e){var l=$(e).parent().attr("id")?Object.keys($(e).data())[0]:$(e).val();["sn","os_ver","date"].indexOf($(e).attr("name"))<0&&!l?(n="Please, fill required fields"+$(e).attr("name"),$(e).parent().addClass("req")):a[$(e).attr("name")]=l}),n?alr.show({class:"alrDanger",content:n,delay:2}):($(t).attr("disabled",!0),$.post("/quote",a,function(e){"OK"==e?($(".quote-steps textarea, .quote-steps input").val(""),alr.show({class:"alrSuccess",content:"Your request has been successfully sent.",delay:2}),mdl.close()):"email_err"==e?alr.show({class:"alrDanger",content:"Email already exists. Please, login and try again",delay:2}):"err_date"==e?alr.show({class:"alrDanger",content:"Date can not be less than today",delay:2}):"enter_req"==e?alr.show({class:"alrDanger",content:"Enter required fields",delay:2}):alr.show({class:"alrDanger",content:lang[13],delay:2}),$(t).removeAttr("disabled")}))}};function initMap(){for(n in map="",marker="",bounds=new google.maps.LatLngBounds,geocoder=new google.maps.Geocoder,near=null,map=new google.maps.Map(document.getElementById("map"),{center:locations[0],scrollwheel:!1,zoom:16,mapTypeId:google.maps.MapTypeId.roadmap}),locations)marker=new google.maps.Marker({position:locations[n],map:map,icon:{url:"/templates/site/img/marker.png",scaledSize:new google.maps.Size(121,76)},infowindow:new google.maps.InfoWindow({content:locations[n].address+"<br>"+locations[n].phone})}),bounds.extend(marker.position),google.maps.event.addListener(marker,"click",function(){this.infowindow.open(map,this)});locations.length>1?map.fitBounds(bounds):map.setZoom(16)}function nearStore(t){var e=new google.maps.LatLngBounds;for(n in locations)e.extend(locations[n]);geocoder.geocode({address:"USA "+t},function(t,a){if(near&&(near.setMap(null),near=null),a==google.maps.GeocoderStatus.OK){var n=new google.maps.Marker({map:map,position:t[0].geometry.location});e.extend(t[0].geometry.location),map.fitBounds(e),near=n}})}function rad(t){return t*Math.PI/180}function find_closest_marker(t,e){if(t&&e){var a=[],n=-1;for(i=0;i<locations.length;i++){var l=locations[i].lat,s=locations[i].lng,o=rad(l-t),r=rad(s-e),d=Math.sin(o/2)*Math.sin(o/2)+Math.cos(rad(t))*Math.cos(rad(t))*Math.sin(r/2)*Math.sin(r/2),c=6371*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)));a[i]=c,(-1==n||c<a[n])&&(n=i)}$(".hdr-phone").html('<a href="tel:1-'+locations[n].phone+'">1-'+locations[n].phone+"</a>"),$(".neare_store").html(locations[n].name),locations.unshift(...locations.splice(n,1)),window.map_id=locations[n].map_id,console.log("ok")}}function signatureSave(){var t=document.getElementById("signature").toDataURL("image/png");document.getElementById("saveSignature").src=t}function signatureClear(){var t=document.getElementById("canvas"),e=document.getElementById("newSignature");t.removeChild(e),empty=!0,signatureCapture()}$.fn.signature=function(){function t(e){var a=$("<canvas/>")[0],n=a.getContext("2d");if(!n)throw new Error("Failed to get canvas' 2d context");a.width=500,a.height=250,n.fillStyle="#fff",n.strokeStyle="#444",n.lineWidth=1.2,n.lineCap="round",n.fillRect(0,0,a.width,a.height),n.fillStyle="#3a87ad",n.strokeStyle="#3a87ad",n.lineWidth=1,n.moveTo(20,220),n.lineTo(454,220),n.stroke(),n.fillStyle="#fff",n.strokeStyle="#444";var l=[],s={},o={},i=!1,r=$("<input/>",{type:"text",name:"signature",required:!0});{function d(t){var e,n;if(t.changedTouches&&t.changedTouches[0]){var l=a.offsetTop||0,s=a.offsetLeft||0;e=t.changedTouches[0].pageX-s,n=t.changedTouches[0].pageY-l}else t.layerX||0==t.layerX?(e=t.layerX,n=t.layerY):(t.offsetX||0==t.offsetX)&&(e=t.offsetX,n=t.offsetY);return{x:e,y:n}}function c(t){t.preventDefault(),t.stopPropagation(),a.addEventListener("mousemove",p,!1),a.addEventListener("mouseup",u,!1),a.addEventListener("touchmove",p,!1),a.addEventListener("touchend",u,!1),document.body.addEventListener("mouseup",u,!1),document.body.addEventListener("touchend",u,!1),empty=!1;var e=d(t);n.beginPath(),l.push("moveStart"),n.moveTo(e.x,e.y),l.push(e.x,e.y),s=e}function p(t,e){t.preventDefault(),t.stopPropagation();var a=d(t),r={x:(s.x+a.x)/2,y:(s.y+a.y)/2};if(i){var c=(o.x+s.x+r.x)/3,p=(o.y+s.y+r.y)/3;l.push(c,p)}else i=!0;n.quadraticCurveTo(s.x,s.y,r.x,r.y),l.push(r.x,r.y),n.stroke(),n.beginPath(),n.moveTo(r.x,r.y),o=r,s=a}function u(t){a.removeEventListener("mousemove",p,!1),a.removeEventListener("mouseup",u,!1),a.removeEventListener("touchmove",p,!1),a.removeEventListener("touchend",u,!1),document.body.removeEventListener("mouseup",u,!1),document.body.removeEventListener("touchend",u,!1),!1,n.stroke(),l.push("e"),i=!1,r.val(a.toDataURL("image/png"))}}a.addEventListener("mousedown",c,!1),a.addEventListener("touchstart",c,!1),$(e).append(a).append($("<a/>",{href:"#",text:"Clear"}).click(function(a){return a.preventDefault(),$(e).empty(),t(e),!1})).append(r)}this.each(function(){t(this)})};