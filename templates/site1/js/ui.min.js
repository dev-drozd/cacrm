function scrollWidth(){return window.innerWidth-document.documentElement.clientWidth}!function(t){t.fn.upload=function(e){var a="string"==typeof e?e:t.extend({autoUpload:!1,count:0,multiple:!1,accept:"image/*",size:10,max:1,check:function(){}},e);return t(this).each(function(e,n){var i=this;i.files={},i.count=a.count,i["delete"]=[],i.input=t("<input/>",{type:"file",accept:a.accept,multiple:a.multiple}).change(function(t){i.check(t.target)}),t(window).bind("dragenter dragover",function(t){t.preventDefault()}).bind("dragleave",function(t){}).bind("drop",function(t){t=t.originalEvent,t.preventDefault(),t.stopPropagation(),t.dataTransfer.files.length&&i.check(t.dataTransfer)}),t(i).click(function(){i.input.click()}),i.check=function(e){var n=Object.keys(i.files).length,s=e.files;return n+i.count+s.length>a.max?void a.check.apply(i,[{error:"max",files:s}]):(t.each(s,function(t){return this.type.match(/image\/(jpeg|jpg|png|gif)/i)?this.size>1024*a.size*1024?void a.check.apply(i,[{error:"size",file:this}]):a.check.apply(i,[{file:this}])===!1?!1:void(i.files[this.name]=this):void a.check.apply(i,[{error:"type",file:this}])}),void i.upload())},i.upload=function(){a.auto}}),this},t.fn.checkbox=function(e){t('input[type="checkbox"]').each(function(e,a){t(a).next().hasClass("cbWrap")||t(a).hide().val(t(a).is(":checked")?1:0).after(t("<div/>",{"class":"cbWrap",html:t("<span/>")}).click(function(e){t(a).val(t(a).is(":checked")?0:1).prop("checked",!t(a).prop("checked")),a.onchange&&a.onchange()}))})},t.fn.radio=function(e){t('input[type="radio"]').each(function(e,a){t(a).parent().hasClass("rbWrap")||t(a).wrap(t("<div/>",{"class":"rbWrap"})).parent().append(t("<label/>",{"class":"rdLbl",html:t(a).attr("data-label")}).click(function(e){t(this).parent().find("input").trigger("click"),a.onchange&&a.onchange()}))})},t.fn.select=function(e){t("select").each(function(e,a){if(!t(a).next().hasClass("sWrap")){t(a).attr("required")&&!t(a).val().length&&t(a).find("option").first().attr("selected",!0),t(a).hide(0).after(t("<div/>",{"class":"sWrap",html:t("<ul/>")})),t(a).attr("multiple")||t(a).next().prepend(t("<div/>").click(function(){t(a).next().find("ul").slideToggle("fast")}));var n=t(a).next().find("ul");t(a).find("option").each(function(){n.append(t("<li/>",{"class":t(this).prop("selected")?"active":"","data-value":t(this).val(),html:t(this).text()}).click(function(){t(a).attr("required")&&t(a).val()==t(this).attr("data-value")?alr.show({"class":"alrDanger",content:"The field must have a value",delay:1.5}):(t(a).attr("multiple")||(t(a).next().find("div").html(t(this).html()).next().slideToggle("fast"),t(a).next().find("li").removeClass("active")),t(this).toggleClass("active"),t(a).find('option[value="'+t(this).attr("data-value")+'"]').prop("selected",!t(a).find('option[value="'+t(this).attr("data-value")+'"]').prop("selected")).trigger("change"))})),!t(a).attr("multiple")&&t(this).prop("selected")&&t(a).next().find("div").html(t(this).text())}),t(a).change(function(e){t(a).attr("multiple")?t(a).find("option").each(function(){t(this).prop("selected")?n.find('li[data-value="'+t(this).val()+'"]').addClass("active"):n.find('li[data-value="'+t(this).val()+'"]').removeClass("active")}):t(a).next().find("div").html(t(a).next().find('li[data-value="'+t(a).val()+'"]').text())})}})},t.fn.sForm=function(e,a,n){return this.each(function(){function i(e,a){h=e,t(".sfWrap").css("z-index","1"),t(e).parent().css("z-index","99999"),t(e).next().slideDown(),t("html").on("click",function(a){t(a.target).hasClass("nc")||(t(e).parent().css("z-index","1"),t(e).next().slideUp(),t(e).off("click").on("click",function(){i(e)}),t("html").off("click"))}),t(e).off("click").on("click",function(a){t(a.target).attr("id")||(t(e).parent().css("z-index","1"),t(e).next().slideUp(),t(e).off("click").on("click",function(){i(e),t("html").off("click")}))})}function s(){r.select&&t.each(r.select,function(t,e){c(e,t)})}function l(){f||(f=!0,r.data.lId=o.find("li:last").attr("data-value"),t.post(r.action,r.data,function(e){e&&(t.each(e.list,function(e,a){o.parent().find("ul").append(t("<li/>",{"class":"nc","data-value":a.id,"data-price":"$"+a.price,"data-tax":a.tax,"data-catname":a.catname,html:a.name}).click(function(){c(t(this))}))}),f=!1)},"json"))}function c(e,s){var l=s?s:e.attr("data-value"),c=s?e.name:e.text(),p=s?e.lastname:e.text().split(" ")[1],f=s?e.price:e.attr("data-price");catname=s?e.catname:e.attr("data-catname"),tax=s?e.tax:e.attr("data-tax"),photo=s?e.photo:e.attr("data-image"),r.s&&o.parent().parent().find("div > span").each(function(e,a){d(t(a),l)}),o.parent().parent().find("input").before(t("<span/>",{id:l,"class":"nc","data-image":photo,"data-price":f,"data-tax":tax,"data-catname":catname,html:c}).append(t("<i/>")).click(function(e){d(t(this),l)})),o.parent().parent().find('li[data-value="'+l+'"]')&&o.parent().find('li[data-value="'+l+'"]').remove(),r.s?(u={},u[l]={name:c,lastname:p,photo:photo,price:f,catname:catname,tax:tax},a.removeData().data(u),r.nIds=[l],o.parent().slideUp(),t(h).off("click").on("click",function(){i(h)})):(u=a.data(),u[l]={name:c,lastname:p,price:f,catname:catname,tax:tax,photo:photo},a.data(u),r.nIds.push(l)),n&&n()}function d(e,n){o.parent().find("ul").append(t("<li/>",{"data-value":e.attr("id"),"data-price":e.attr("data-price"),"data-catname":e.attr("data-catname"),"data-image":e.attr("data-image"),"data-tax":e.attr("data-tax"),html:e.html()}).click(function(){c(t(this))})),e.remove(),u=a.data(),delete u[n],a.data(u),r.s&&a.removeData(),delete r.select[n],r.nIds.splice(r.nIds.indexOf(n),1)}t("html").off("click");var o=t(this),r={s:!1,all:!1,data:{lId:0},select:{},nIds:[]},f=!1,h=void 0;if("object"!=typeof e&&e)"object"!=typeof e&&"get"==e&&a.removeData().data(r.select);else{t(this).removeClass("hdn").wrap(t("<span/>"));var u={};t.extend(!0,r,e),t(this).find("li").addClass("nc"),t(this).addClass("nc").parent().wrap(t("<div/>",{"class":"sfWrap nc",style:"z-index: 1"})).parent().prepend(t("<div/>",{"class":"nc",html:t("<input/>",{type:"text","class":"nc",placeholder:"Search..."})}).click(function(t){i(this)})).find("li").click(function(){c(t(this))}),o.parents(".mdl")&&(p=(t(window).height()-o.parents(".mdl").height())/2,o.parents(".mdlWrap").css("padding-top",(p<20?20:p)+"px")),s()}o.parent().on("scroll",function(){t(this).scrollTop()>=o.find("ul").height()-o.height()-20&&!r.all&&l()}).parents(".sfWrap").find("input").keyup(function(){r.all?(o.parent().find("li").show(),t.each(o.find("li"),function(){o.parent().parent().find("input").val()&&t(this).text().toLowerCase().indexOf(o.parent().parent().find("input").val().toLowerCase())<0&&t(this).hide()})):(o.parent().find("ul").empty(),r.data.query=o.parent().parent().find("input").val(),l())})})},t.fn.tabs=function(e){t(".tabs").each(function(e,a){var a=t(this);a.find(".tUl").length||a.prepend(t("<ul/>",{"class":"tUl"})).find(".tab:first").css("display","block").parent().find(".tab").each(function(e,n){a.find(".tUl").append(t("<li/>",{"data-value":t(this).attr("id"),html:t(this).attr("data-title"),"class":e?"":"active"}).click(function(){el=t(this),el.parent().find(".active").removeClass("active"),el.addClass("active"),a.find(".tab").hide(0,function(){t("#"+el.attr("data-value")).show(0)})}))})})},jQuery.fn.rbtSlider=function(e){return this.each(function(){function a(e,a){a?nextItem=n.find(".slItem").eq(a-1):("prev"==e?n.find(".slItem.active").prev().length?nextItem=n.find(".slItem.active").prev():nextItem=n.find(".slItem").last():n.find(".slItem.active").next().length?nextItem=n.find(".slItem.active").next():nextItem=n.find(".slItem").first(),n.find(".slDots > .active").removeClass("active").parent().find(".slDotsSingle").eq(nextItem.index()).addClass("active")),nextItem.addClass(e+"Item").delay(50).queue(function(){n.find(".slItems > .active").addClass(e).delay(700).queue(function(){t(this).removeClass(e+" active").dequeue()}),t(this).addClass(e).delay(700).queue(function(){t(this).removeClass(e+" "+e+"Item").addClass("active").clearQueue()}),t(this).dequeue()})}var n=t(this);if(e.height&&n.css("height",e.height),n.find(".slItem").first().addClass("active"),e.dots){var i=n.find(".slItem").length;n.append(t("<div/>",{"class":"slDots",html:t("<div/>",{"class":"slDotsSingle active"})}));for(var s=1;i>s;s++)n.find(".slDotsSingle.active").clone().removeClass("active").appendTo(t(this).find(".slDots"));n.find(".slDotsSingle").on("click",function(){curIndex=t(this).parents(".slDots").find(".active").removeClass("active").index()+1,index=t(this).addClass("active").index()+1,index!=curIndex&&(index>curIndex?a("next",index):a("prev",index))})}if(e.arrows&&n.append(t("<div/>",{"class":"ctrlPrev",html:"&lsaquo;"}).on("click",function(){a("prev")})).append(t("<div/>",{"class":"ctrlNext",html:"&rsaquo;"}).on("click",function(){a("next")})),e.auto){var l=setInterval(function(){a("next")},1e3*e.auto);n.on("mouseover",function(){clearInterval(l)}).on("mouseleave",function(){l=setInterval(function(){a("next")},1e3*e.auto)})}})},jQuery.fn.carousel=function(){return this.each(function(){var e=t(this),a=e.find(".igItem").length*(e.find(".igItem")[0].offsetWidth+15)-15;e.find(".igGroupCtnr").css("width",a+"px"),t(window).resize(function(){e.find(".igGroupCtnr").css("margin-left",0)}),a>e.width()?e.parents(".itemGroup").find(".igArrows").find("span").on("mousedown touchstart",function(){t(this).hasClass("fa-chevron-left")?e.find(".igGroupCtnr").animate({marginLeft:0},700):e.find(".igGroupCtnr").animate({marginLeft:-e.find(".igGroupCtnr").width()+e.width()},1e3)}).on("mouseup touchend",function(){e.find(".igGroupCtnr").stop(),parseFloat(e.find(".igGroupCtnr").css("margin-left"))?parseFloat(e.find(".igGroupCtnr").css("margin-left"))==e.width()-a?e.parents(".itemGroup").find(".fa-chevron-right").addClass("disable").parent().find(".fa-chevron-left").removeClass("disable"):e.parents(".itemGroup").find(".fa-chevron-left").removeClass("disable").parent().find(".fa-chevron-right").removeClass("disable"):e.parents(".itemGroup").find(".fa-chevron-left").addClass("disable").parent().find(".fa-chevron-right").removeClass("disable")}):e.parents(".itemGroup").find(".igArrows").hide()})}}(jQuery);var alr={show:function(t){t.form&&$(t.form).css("background","rgba(255, 0, 0, 0.18)").mousedown(function(){$(this).css("background","").unbind("mousedown")}),$(".alr").length||($("<div/>",{"class":"alr "+(t["class"]||"alrInfo"),style:t.color?"background: "+t.color:"",html:t.content}).append($("<span/>",{"class":"alrClose fa fa-times",onclick:"alr.close()"})).appendTo("body"),t.delay&&setTimeout(function(){alr.close()},1e3*t.delay))},close:function(){$(".alr").fadeOut("fast",function(){$(".alr").remove()})}},mdl={open:function(t){var e={id:Math.floor(1e7*Math.random()+1)},a=0;$("body").css({overflow:"hidden","padding-right":scrollWidth()+"px"}),$.extend(e,t),a=$(window).width()/2-(e.width?e.width:500)/2,$("<div/>",{"class":"mdlWrap "+(e["class"]||""),id:e.id,style:"overflow-y: hidden;",onclick:'mdl.close("'+e.id+'", event)',html:$("<div/>",{"class":"mdl",style:(e.width?"width: "+e.width+"px; ":"")+"margin-left: "+(10>a?"10":a)+"px",html:e.title?$("<div/>",{"class":"mdlTitle",html:$("<span/>",{"class":"mdlClose fa fa-times",onclick:'mdl.close("'+e.id+'", event);'})}).prepend(e.title):""}).append($("<div/>",{"class":"mdlBody",html:e.content})).append(e.footer?$("<div/>",{"class":"mdlFooter",html:e.footer}):"")}).appendTo("body"),$("#"+e.id).show(0,function(){p=($(window).height()-$("#"+e.id+" > .mdl").height())/2,$("#"+e.id).css("padding-top",(p<20?20:p)+"px"),$(this).find(".mdl").addClass("show").delay(300).queue(function(){$("#"+e.id).css("overflow","auto").find(".mdl").clearQueue(),e.cb&&e.cb(e.id)})})},close:function(t,e){el=t?$("#"+t):$(".mdlWrap"),(!e||e.target.className.indexOf("mdlWrap")>=0||e.target.className.indexOf("mdlClose")>=0)&&el.css("overflow","hidden").find(".mdl").removeClass("show").delay(350).queue(function(){el.remove(),$("body").css({"overflow-y":"scroll","padding-right":0}).clearQueue()})}},showPhoto={curr:{},show:function(t,e){$("body").append($("<div/>",{"class":"photoWrap",onclick:e?"":"$(this).remove();",html:$("<span/>",{"class":"fa fa-times",onclick:"$(this).parent().remove();"})}).append($("<img/>",{src:t.replace("thumb_","").replace("preview_",""),onclick:'showPhoto.next("'+e+'", 1);'}))),e&&($("#"+e).parent().next().find(".active").length||$("#"+e).parent().next().find(".igItem").first().addClass("active"),$("#"+e).parent().next().find(".active").addClass("show"),$(".photoWrap").append($("<span/>",{"class":"fa fa-chevron-left spArrow",onclick:'showPhoto.next("'+e+'");'})).append($("<span/>",{"class":"fa fa-chevron-right spArrow",onclick:'showPhoto.next("'+e+'", 1);'})).append($("<span/>",{"class":"fa fa-spinner fa-spin"})))},next:function(t,e){$(".photoWrap > img").css("opacity","0"),$(".fa-spinner").css("display","block"),curr=$("#"+t).parent().next().find(".show").removeClass("show"),e?curr.next().length?curr.next().addClass("show"):curr.parents(".igGroupCtnr").find(".igItem").first().addClass("show"):curr.prev().length?curr.prev().addClass("show"):curr.parents(".igGroupCtnr").find(".igItem").last().addClass("show"),document.querySelector(".photoWrap > img").onload=function(){$(".photoWrap > img").css("opacity","1"),$(".fa-spinner").css("display","none")},$(".photoWrap > img").attr("src",$("#"+t).parent().next().find(".show > img").attr("src").replace("thumb_","").replace("preview_",""))},change:function(t){$(t).parents(".igGroupCtnr").find(".active").removeClass("active"),$(t).parent().addClass("active").parents(".itemPhotosSet").prev().find("img").attr("src",$(t).attr("src"))}},loadBtn={"class":"",start:function(t){loadBtn["class"]=t.attr("disabled",!0).find("span").attr("class"),t.find("span").removeClass(loadBtn["class"]).addClass("fa fa-refresh fa-spin")},stop:function(t){t.attr("disabled",!1).find("span").removeClass("fa fa-refresh fa-spin").addClass(loadBtn["class"])}};
!function(t,e,i,o){function s(t,e){var i=Math.max(0,t[0]-e[0],e[0]-t[1]),o=Math.max(0,t[2]-e[1],e[1]-t[3]);return i+o}function n(e,i,o,s){var n=e.length,r=s?"offset":"position";for(o=o||0;n--;){var a=e[n].el?e[n].el:t(e[n]),h=a[r]();h.left+=parseInt(a.css("margin-left"),10),h.top+=parseInt(a.css("margin-top"),10),i[n]=[h.left-o,h.left+a.outerWidth()+o,h.top-o,h.top+a.outerHeight()+o]}}function r(t,e){var i=e.offset();return{left:t.left-i.left,top:t.top-i.top}}function a(t,e,i){e=[e.left,e.top],i=i&&[i.left,i.top];for(var o,n=t.length,r=[];n--;)o=t[n],r[n]=[n,s(o,e),i&&s(o,i)];return r=r.sort(function(t,e){return e[1]-t[1]||e[2]-t[2]||e[0]-t[0]})}function h(e){this.options=t.extend({},u,e),this.containers=[],this.options.rootGroup||(this.scrollProxy=t.proxy(this.scroll,this),this.dragProxy=t.proxy(this.drag,this),this.dropProxy=t.proxy(this.drop,this),this.placeholder=t(this.options.placeholder),e.isValidTarget||(this.options.isValidTarget=o))}function l(e,i){this.el=e,this.options=t.extend({},c,i),this.group=h.get(this.options),this.rootGroup=this.options.rootGroup||this.group,this.handle=this.rootGroup.options.handle||this.rootGroup.options.itemSelector;var o=this.rootGroup.options.itemPath;this.target=o?this.el.find(o):this.el,this.target.on(g.start,this.handle,t.proxy(this.dragInit,this)),this.options.drop&&this.group.containers.push(this)}var c={drag:!0,drop:!0,exclude:"",nested:!0,vertical:!0},u={afterMove:function(t,e,i){},containerPath:"",containerSelector:"ol, ul",distance:0,delay:0,handle:"",itemPath:"",itemSelector:"li",bodyClass:"dragging",draggedClass:"dragged",isValidTarget:function(t,e){return!0},onCancel:function(t,e,i,o){},onDrag:function(t,e,i,o){t.css(e)},onDragStart:function(e,i,o,s){e.css({height:e.outerHeight(),width:e.outerWidth()}),e.addClass(i.group.options.draggedClass),t("body").addClass(i.group.options.bodyClass)},onDrop:function(e,i,o,s){e.removeClass(i.group.options.draggedClass).removeAttr("style"),t("body").removeClass(i.group.options.bodyClass)},onMousedown:function(t,e,i){return i.target.nodeName.match(/^(input|select|textarea)$/i)?void 0:(i.preventDefault(),!0)},placeholderClass:"placeholder",placeholder:'<li class="placeholder"></li>',pullPlaceholder:!0,serialize:function(e,i,o){var s=t.extend({},e.data());return o?[i]:(i[0]&&(s.children=i),delete s.subContainers,delete s.sortable,s)},tolerance:0},p={},f=0,d={left:0,top:0,bottom:0,right:0},g={start:"touchstart.sortable mousedown.sortable",drop:"touchend.sortable touchcancel.sortable mouseup.sortable",drag:"touchmove.sortable mousemove.sortable",scroll:"scroll.sortable"},m="subContainers";h.get=function(t){return p[t.group]||(t.group===o&&(t.group=f++),p[t.group]=new h(t)),p[t.group]},h.prototype={dragInit:function(e,i){this.$document=t(i.el[0].ownerDocument);var o=t(e.target).closest(this.options.itemSelector);if(o.length){if(this.item=o,this.itemContainer=i,this.item.is(this.options.exclude)||!this.options.onMousedown(this.item,u.onMousedown,e))return;this.setPointer(e),this.toggleListeners("on"),this.setupDelayTimer(),this.dragInitDone=!0}},drag:function(t){if(!this.dragging){if(!this.distanceMet(t)||!this.delayMet)return;this.options.onDragStart(this.item,this.itemContainer,u.onDragStart,t),this.item.before(this.placeholder),this.dragging=!0}this.setPointer(t),this.options.onDrag(this.item,r(this.pointer,this.item.offsetParent()),u.onDrag,t);var e=this.getPointer(t),i=this.sameResultBox,s=this.options.tolerance;(!i||i.top-s>e.top||i.bottom+s<e.top||i.left-s>e.left||i.right+s<e.left)&&(this.searchValidTarget()||(this.placeholder.detach(),this.lastAppendedItem=o))},drop:function(t){this.toggleListeners("off"),this.dragInitDone=!1,this.dragging&&(this.placeholder.closest("html")[0]?this.placeholder.before(this.item).detach():this.options.onCancel(this.item,this.itemContainer,u.onCancel,t),this.options.onDrop(this.item,this.getContainer(this.item),u.onDrop,t),this.clearDimensions(),this.clearOffsetParent(),this.lastAppendedItem=this.sameResultBox=o,this.dragging=!1)},searchValidTarget:function(t,e){t||(t=this.relativePointer||this.pointer,e=this.lastRelativePointer||this.lastPointer);for(var i=a(this.getContainerDimensions(),t,e),s=i.length;s--;){var n=i[s][0],h=i[s][1];if(!h||this.options.pullPlaceholder){var l=this.containers[n];if(!l.disabled){if(!this.$getOffsetParent()){var c=l.getItemOffsetParent();t=r(t,c),e=r(e,c)}if(l.searchValidTarget(t,e))return!0}}}this.sameResultBox&&(this.sameResultBox=o)},movePlaceholder:function(t,e,i,o){var s=this.lastAppendedItem;(o||!s||s[0]!==e[0])&&(e[i](this.placeholder),this.lastAppendedItem=e,this.sameResultBox=o,this.options.afterMove(this.placeholder,t,e))},getContainerDimensions:function(){return this.containerDimensions||n(this.containers,this.containerDimensions=[],this.options.tolerance,!this.$getOffsetParent()),this.containerDimensions},getContainer:function(t){return t.closest(this.options.containerSelector).data(i)},$getOffsetParent:function(){if(this.offsetParent===o){var t=this.containers.length-1,e=this.containers[t].getItemOffsetParent();if(!this.options.rootGroup)for(;t--;)if(e[0]!=this.containers[t].getItemOffsetParent()[0]){e=!1;break}this.offsetParent=e}return this.offsetParent},setPointer:function(t){var e=this.getPointer(t);if(this.$getOffsetParent()){var i=r(e,this.$getOffsetParent());this.lastRelativePointer=this.relativePointer,this.relativePointer=i}this.lastPointer=this.pointer,this.pointer=e},distanceMet:function(t){var e=this.getPointer(t);return Math.max(Math.abs(this.pointer.left-e.left),Math.abs(this.pointer.top-e.top))>=this.options.distance},getPointer:function(t){var e=t.originalEvent||t.originalEvent.touches&&t.originalEvent.touches[0];return{left:t.pageX||e.pageX,top:t.pageY||e.pageY}},setupDelayTimer:function(){var t=this;this.delayMet=!this.options.delay,this.delayMet||(clearTimeout(this._mouseDelayTimer),this._mouseDelayTimer=setTimeout(function(){t.delayMet=!0},this.options.delay))},scroll:function(t){this.clearDimensions(),this.clearOffsetParent()},toggleListeners:function(e){var i=this,o=["drag","drop","scroll"];t.each(o,function(t,o){i.$document[e](g[o],i[o+"Proxy"])})},clearOffsetParent:function(){this.offsetParent=o},clearDimensions:function(){this.traverse(function(t){t._clearDimensions()})},traverse:function(t){t(this);for(var e=this.containers.length;e--;)this.containers[e].traverse(t)},_clearDimensions:function(){this.containerDimensions=o},_destroy:function(){p[this.options.group]=o}},l.prototype={dragInit:function(t){var e=this.rootGroup;!this.disabled&&!e.dragInitDone&&this.options.drag&&this.isValidDrag(t)&&e.dragInit(t,this)},isValidDrag:function(t){return 1==t.which||"touchstart"==t.type&&1==t.originalEvent.touches.length},searchValidTarget:function(t,e){var i=a(this.getItemDimensions(),t,e),o=i.length,s=this.rootGroup,n=!s.options.isValidTarget||s.options.isValidTarget(s.item,this);if(!o&&n)return s.movePlaceholder(this,this.target,"append"),!0;for(;o--;){var r=i[o][0],h=i[o][1];if(!h&&this.hasChildGroup(r)){var l=this.getContainerGroup(r).searchValidTarget(t,e);if(l)return!0}else if(n)return this.movePlaceholder(r,t),!0}},movePlaceholder:function(e,i){var o=t(this.items[e]),s=this.itemDimensions[e],n="after",r=o.outerWidth(),a=o.outerHeight(),h=o.offset(),l={left:h.left,right:h.left+r,top:h.top,bottom:h.top+a};if(this.options.vertical){var c=(s[2]+s[3])/2,u=i.top<=c;u?(n="before",l.bottom-=a/2):l.top+=a/2}else{var p=(s[0]+s[1])/2,f=i.left<=p;f?(n="before",l.right-=r/2):l.left+=r/2}this.hasChildGroup(e)&&(l=d),this.rootGroup.movePlaceholder(this,o,n,l)},getItemDimensions:function(){return this.itemDimensions||(this.items=this.$getChildren(this.el,"item").filter(":not(."+this.group.options.placeholderClass+", ."+this.group.options.draggedClass+")").get(),n(this.items,this.itemDimensions=[],this.options.tolerance)),this.itemDimensions},getItemOffsetParent:function(){var t,e=this.el;return t="relative"===e.css("position")||"absolute"===e.css("position")||"fixed"===e.css("position")?e:e.offsetParent()},hasChildGroup:function(t){return this.options.nested&&this.getContainerGroup(t)},getContainerGroup:function(e){var s=t.data(this.items[e],m);if(s===o){var n=this.$getChildren(this.items[e],"container");if(s=!1,n[0]){var r=t.extend({},this.options,{rootGroup:this.rootGroup,group:f++});s=n[i](r).data(i).group}t.data(this.items[e],m,s)}return s},$getChildren:function(e,i){var o=this.rootGroup.options,s=o[i+"Path"],n=o[i+"Selector"];return e=t(e),s&&(e=e.find(s)),e.children(n)},_serialize:function(e,i){var o=this,s=i?"item":"container",n=this.$getChildren(e,s).not(this.options.exclude).map(function(){return o._serialize(t(this),!i)}).get();return this.rootGroup.options.serialize(e,n,i)},traverse:function(e){t.each(this.items||[],function(i){var o=t.data(this,m);o&&o.traverse(e)}),e(this)},_clearDimensions:function(){this.itemDimensions=o},_destroy:function(){var e=this;this.target.off(g.start,this.handle),this.el.removeData(i),this.options.drop&&(this.group.containers=t.grep(this.group.containers,function(t){return t!=e})),t.each(this.items||[],function(){t.removeData(this,m)})}};var v={enable:function(){this.traverse(function(t){t.disabled=!1})},disable:function(){this.traverse(function(t){t.disabled=!0})},serialize:function(){return this._serialize(this.el,!0)},refresh:function(){this.traverse(function(t){t._clearDimensions()})},destroy:function(){this.traverse(function(t){t._destroy()})}};t.extend(l.prototype,v),t.fn[i]=function(e){var s=Array.prototype.slice.call(arguments,1);return this.map(function(){var n=t(this),r=n.data(i);return r&&v[e]?v[e].apply(r,s)||this:(r||e!==o&&"object"!=typeof e||n.data(i,new l(n,e)),this)})}}(jQuery,window,"sortable");

(function($){
// Calendar
	$.fn.calendar = function (cb) {
        var month = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            week = ['Sun', 'Mon', 'Tue', 'Wen', 'Thu', 'Fri', 'Sat'],
            today = new Date();
        return this.each(function () {
            var e = this, c = 0;
            $(e).addClass('calendar cl').append($('<input/>', {
                type: 'hidden',
                name: 'date'
            }));
            if ($(e).attr('data-multiple')) {
                $(e).append($('<input/>', {
                    type: 'hidden',
                    name: 'fDate'
                }));
            }

            // Header / Content
            $(e).append($('<div/>', {
                class: 'calHeader cl',
                html: $('<span/>', {
                    class: 'calArrow cl',
                    html: '&lsaquo;'
                }).click(function () { 
                    selMonth('prev');
                })
            }).append($('<span/>', {
                class: 'calCur cl',
                html: $('<span/>', {
                    class: 'calMonth cl',
                    html: $('<i/>', {
						class: 'cl',
                        html: month[today.getMonth()]
                    }),
                    onclick: '$(this).toggleClass(\'active\');'
                }).append($('<span/>'))
            }).append($('<span/>', {
                class: 'calYear cl',
                html: today.getFullYear()
            }).on('click', function () { 
                yearClick(this);
            }))).append($('<span/>', {
                class: 'calArrow cl',
                html: '&rsaquo;'
            }).click(function () { 
                selMonth('next');
            }))).append($('<div/>', {
                class: 'calContent cl',
                html: $('<div/>', {
                    class: 'calWeek cl'
                })
            }).append($('<div/>', {
                class: 'calDays cl'
            })));
            
            // Months
            $.each(month, function (j, m) {
                $(e).find('.calMonth > span').append($('<span/>', {
                    'data-value': j,
					class: 'cl',
                    html: m
                }).click(function () { 
                    days($(e).find('.calYear').text(), parseInt($(this).attr('data-value')) + 1);
                }))
            });
            $(e).find('.calMonth').find('span[data-value="' + today.getMonth() + '"]').addClass('active');

            // Day of week
            $.each(week, function (j, d) {
                $(e).find('.calWeek').append($('<span/>', {
					class: 'cl',
                    value: j,
                    html: d
                }))
            });
			
			if ($(e).attr('data-year') && $(e).attr('data-month'))
				days($(e).attr('data-year'), $(e).attr('data-month'), $(e).attr('data-day'));
			else
				days(today.getFullYear(), today.getMonth() + 1);
           
            // Days
            function days(y, m, dd) {
                $(e).find('.calDays').html($('<span/>', {
                    style: 'width: ' + (new Date(month[m - 1] + ' 1, ' + y).getDay() * 14.286) + '%'
                }));
                for (var d = 1; d <= new Date(y, m, 0).getDate(); d++) {
                    $(e).find('.calDays').append($('<span/>', {
                        class: 'calDay cl' + (dd == d ? ' active' : ''),
						month: m > 10 ? '0' + m : m,
                        html: d
                    }).on('click', function () {
                        if (c == 1) {
							var val = $(e).find('input[name="date"]').val().split('-');
							if (parseInt($('.calYear').text() + '' + (
									$(this).attr('month') < 10 ? '0' + $(this).attr('month') : $(this).attr('month')
								) + '' + ($(this).text().length < 2 ? '0' + $(this).text() : $(this).text())) >= 
							parseInt(val[0] + val[1] + val[2])) {
								$(this).addClass('active');
								var month = parseInt($(e).find('.calMonth > span').find('.active').attr('data-value')) + 1,
									day = parseInt($(this).text());
								$(e).find('input[name="fDate"]').val(
									parseInt($(e).find('.calYear').text()) + '-' + (month < 10 ? '0' + month : month)
									+ '-' + (day < 10 ? '0' + day : day)
								);
								c = 0;
								if (cb) cb();
							}
                        } else {
							$(e).find('.calDays > .active').removeClass('active');
                            $(this).addClass('active');
							var month = parseInt($(e).find('.calMonth > span').find('.active').attr('data-value')) + 1,
								day = parseInt($(this).text());
                            $(e).find('input[name="date"]').val(
                                parseInt($(e).find('.calYear').text()) + '-' + (m < 10 ? '0' + m : m)
                                + '-' + (day < 10 ? '0' + day : day)
                            );
                            if ($(e).attr('data-multiple'))                                
								c = 1;
                            else 
								if (cb) cb();
                        }
                            
                    }));
                }
                $(e).find('.calMonth > i').html(month[m - 1]);
                $(e).find('.calYear').html(y);
                $(e).find('.calMonth > span > .active').removeClass('active').parent().find('span[data-value="' + (m - 1) + '"]').addClass('active');
            }

            // Month nav 
            function selMonth(s) {
                m = parseInt($(e).find('.calMonth > span').find('.active').attr('data-value')) + (s == 'next' ? 2 : 0);
                y = parseInt($(e).find('.calYear').text());
                if (m > 12) {
                    m = 1;
                    y++;
                } else if (m < 1) {
                    m = 12;
                    y--;
                }
                days(y, m);
            }

            // Year nav
            function yearClick(el) {
                $(el).off('click');
                var y = $(el).text();
                $(el).html($('<input/>', {
                    type: 'number',
					class: 'cl',
                    name: 'year',
                    step: 1,
                    value: y
                }).blur(function() {
					 y = $(e).find('.calYear > input').val();
					days(y, parseInt($(e).find('.calMonth .active').attr('data-value')) + 1);
					yearBind(el, y)
				}));
                $(document).on('keydown', function (event) {
                    if (event.keyCode == 13) {
                        y = $(e).find('.calYear > input').val();
                        days(y, parseInt($(e).find('.calMonth .active').attr('data-value')) + 1);
                        yearBind(el, y)
                    } else if (event.keyCode == 27) {
                        yearBind(el)
                    }
                    return event;
                });
            }  
            
            // Year bind
            function yearBind(el, y) {
                $(e).find('.calYear').html(y);
                $(document).off('keydown');
                $(el).on('click', function () { 
                    yearClick(el);
                });
            }
        });
    };
})(jQuery);